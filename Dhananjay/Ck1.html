<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keyboard-Controlled Menu System</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow: hidden; /* Prevent page scroll with arrow keys */
        }

        .menu-button {
            transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
            border-style: solid;
            /* Basic focus outline for accessibility */
            outline: 2px solid transparent;
            outline-offset: 4px;
        }
        
        /* This class provides clear visual feedback for the selected button on sub-menus */
        .keyboard-selected {
            border-color: #f59e0b; /* A bright, high-contrast amber */
            transform: scale(1.05);
            box-shadow: 0 0 25px rgba(245, 158, 11, 0.7);
            background-color: rgba(245, 158, 11, 0.1);
        }

        /* A fallback for basic keyboard navigation if JS fails */
        .menu-button:focus {
             border-color: #f59e0b;
        }

        /* Status message box */
        #status-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            transition: opacity 0.5s ease-in-out;
        }
        
        /* --- Styles for the new main menu --- */
        #main-menu-container {
            width: 100%;
            height: 200px; /* Give the area some height */
        }
        
        #stationary-options-container {
            /* This container will move left and right */
            transition: transform 0.4s cubic-bezier(0.45, 0.05, 0.55, 0.95);
        }

        .main-menu-item {
            width: 200px; /* Give each item a fixed width for consistent spacing */
            transition: all 0.4s cubic-bezier(0.45, 0.05, 0.55, 0.95);
            opacity: 0.5;
            transform: scale(0.8);
        }

        .main-menu-item.is-active {
            opacity: 1;
            transform: scale(1.1);
        }

    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center h-screen overflow-hidden">

    <!-- Status Box for user instructions -->
    <div id="status-box" class="bg-blue-600 text-white py-3 px-6 rounded-lg shadow-xl text-center">
        <p id="status-text">Use Arrow Keys to navigate and Enter to select.</p>
    </div>

    <!-- Main Menu Screen -->
    <div id="main-menu-ui" class="w-full h-full p-8 flex-col items-center justify-center gap-8 hidden">
        <h1 class="text-4xl md:text-5xl font-bold tracking-tight text-gray-200 mb-8">What do you need?</h1>
        <!-- This container is relative to position the stationary circle -->
        <div id="main-menu-container" class="relative flex justify-center items-center">
            <!-- The stationary selector circle, now with a white border -->
            <div id="stationary-circle" class="absolute w-48 h-48 rounded-full border-8 border-white transition-colors duration-300 ease-in-out pointer-events-none"></div>
            <!-- The moving options, now with white text -->
            <div id="stationary-options-container" class="flex items-center">
                 <div class="main-menu-item text-4xl font-bold text-white flex justify-center items-center">Food</div>
                 <div class="main-menu-item text-4xl font-bold text-white flex justify-center items-center">Greet</div>
                 <div class="main-menu-item text-4xl font-bold text-white flex justify-center items-center">X</div>
                 <div class="main-menu-item text-4xl font-bold text-white flex justify-center items-center">Help</div>
                 <div class="main-menu-item text-4xl font-bold text-white flex justify-center items-center">Binge</div>
            </div>
        </div>
    </div>

    <!-- Food Options Screen (remains a grid) -->
    <div id="food-options-ui" class="w-full h-full p-8 flex-col items-center justify-center gap-8 hidden">
        <h1 class="text-4xl md:text-5xl font-bold tracking-tight text-gray-200 mb-8">What food?</h1>
        <div class="grid grid-cols-3 gap-8 w-full max-w-5xl">
            <button data-action="speak" data-text="I'm hungry" class="menu-button bg-yellow-500 text-gray-900 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">I'm Hungry</span></button>
            <button data-action="speak" data-text="Water, please" class="menu-button bg-blue-500 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">Water</span></button>
            <button data-action="speak" data-text="Snack, please" class="menu-button bg-green-500 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">Snack</span></button>
            <button data-action="speak" data-text="Meal, please" class="menu-button bg-red-500 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">Meal</span></button>
            <button data-action="speak" data-text="I'm thirsty" class="menu-button bg-sky-500 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">I'm Thirsty</span></button>
            <button data-action="go-back" class="menu-button bg-gray-600 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">⬅️ Go Back</span></button>
        </div>
    </div>
    
    <!-- Other screens are unchanged -->
    <div id="greet-options-ui" class="w-full h-full p-8 flex-col items-center justify-center gap-8 hidden">...</div>
    <div id="help-options-ui" class="w-full h-full p-8 flex-col items-center justify-center gap-8 hidden">...</div>
    <div id="binge-options-ui" class="w-full h-full p-8 flex-col items-center justify-center gap-8 hidden">...</div>


    <script>
        // --- STATE & CONFIG ---
        const synth = window.speechSynthesis;
        let selectedIndex = 0;
        let activeButtons = [];

        const mainMenuItems = [
            { text: 'Food',  action: 'show-menu', target: 'food-options-ui' },
            { text: 'Greet', action: 'show-menu', target: 'greet-options-ui' },
            { text: 'X',     action: 'speak',     textToSpeak: 'Cancel' },
            { text: 'Help',  action: 'show-menu', target: 'help-options-ui' },
            { text: 'Binge', action: 'show-menu', target: 'binge-options-ui' }
        ];

        const UIs = {
            'main-menu-ui': { element: document.getElementById('main-menu-ui'), type: 'selector' },
            'food-options-ui': { element: document.getElementById('food-options-ui'), type: 'grid', cols: 3 },
            'greet-options-ui': { element: document.getElementById('greet-options-ui'), type: 'grid', cols: 3 },
            'help-options-ui': { element: document.getElementById('help-options-ui'), type: 'grid', cols: 3 },
            'binge-options-ui': { element: document.getElementById('binge-options-ui'), type: 'grid', cols: 3 },
        };
        let currentScreenId = 'main-menu-ui';

        // --- DOM ELEMENT REFERENCES FOR MAIN MENU ---
        let menuItemElements = [];
        let stationaryCircle;
        let optionsContainer;

        // --- CORE FUNCTIONS ---

        function switchScreen(screenId) {
            for (const id in UIs) {
                UIs[id].element.style.display = 'none';
            }
            if (UIs[screenId]) {
                UIs[screenId].element.style.display = 'flex';
                currentScreenId = screenId;
                
                if (UIs[screenId].type === 'selector') {
                    selectedIndex = Math.floor(mainMenuItems.length / 2); // Start in the middle
                    updateMainMenuSelector();
                } else {
                    activeButtons = Array.from(UIs[screenId].element.querySelectorAll('.menu-button'));
                    selectedIndex = 0;
                    updateGridSelection();
                }
            }
        }
        
        function updateGridSelection() {
            activeButtons.forEach((button, index) => {
                button.classList.toggle('keyboard-selected', index === selectedIndex);
            });
        }

        function updateMainMenuSelector() {
            if (menuItemElements.length === 0 || !stationaryCircle) return;

            const itemWidth = menuItemElements[0].offsetWidth;
            const middleIndex = Math.floor(mainMenuItems.length / 2);
            // This new calculation correctly centers the selected item
            const offset = (middleIndex - selectedIndex) * itemWidth;
            
            optionsContainer.style.transform = `translateX(${offset}px)`;
            
            // Add active class to the text element for visual feedback
            menuItemElements.forEach((el, index) => {
                el.classList.toggle('is-active', index === selectedIndex);
            });
        }


        function performAction(element) {
            const action = element.dataset.action;
            const text = element.dataset.text;
            const target = element.dataset.target;

            if (window.navigator.vibrate) window.navigator.vibrate(50);

            switch (action) {
                case 'speak':
                    if (text) {
                        const utterance = new SpeechSynthesisUtterance(text);
                        synth.speak(utterance);
                    }
                    break;
                case 'show-menu':
                    if (target) switchScreen(target);
                    break;
                case 'go-back':
                    switchScreen('main-menu-ui');
                    break;
            }
        }

        // --- KEYBOARD EVENT LISTENER ---
        document.addEventListener('keydown', (e) => {
            if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'Enter'].includes(e.key)) {
                e.preventDefault();
            }
            
            const screen = UIs[currentScreenId];
            if (!screen) return;

            if (screen.type === 'selector') {
                switch (e.key) {
                    case 'ArrowRight':
                        selectedIndex = (selectedIndex + 1) % mainMenuItems.length;
                        break;
                    case 'ArrowLeft':
                        selectedIndex = (selectedIndex - 1 + mainMenuItems.length) % mainMenuItems.length;
                        break;
                    case 'Enter':
                        const currentItem = mainMenuItems[selectedIndex];
                        if (window.navigator.vibrate) window.navigator.vibrate(50);
                        switch (currentItem.action) {
                            case 'speak':
                                if (currentItem.textToSpeak) {
                                    synth.speak(new SpeechSynthesisUtterance(currentItem.textToSpeak));
                                }
                                break;
                            case 'show-menu':
                                if (currentItem.target) switchScreen(currentItem.target);
                                break;
                        }
                        return;
                }
                updateMainMenuSelector();

            } else {
                if (activeButtons.length === 0) return;
                const cols = screen.cols;
                const buttonCount = activeButtons.length;
                switch (e.key) {
                    case 'ArrowRight':
                        selectedIndex = (selectedIndex + 1) % buttonCount;
                        break;
                    case 'ArrowLeft':
                        selectedIndex = (selectedIndex - 1 + buttonCount) % buttonCount;
                        break;
                    case 'ArrowDown':
                        if (selectedIndex + cols < buttonCount) selectedIndex += cols;
                        break;
                    case 'ArrowUp':
                        if (selectedIndex - cols >= 0) selectedIndex -= cols;
                        break;
                    case 'Enter':
                        performAction(activeButtons[selectedIndex]);
                        return;
                }
                updateGridSelection();
            }
        });

        // --- INITIALIZATION ---
        window.onload = () => {
             setTimeout(() => {
                const statusBox = document.getElementById('status-box');
                if(statusBox) statusBox.style.opacity = '0';
            }, 4000);
            
            // Get references to main menu elements
            stationaryCircle = document.getElementById('stationary-circle');
            optionsContainer = document.getElementById('stationary-options-container');
            menuItemElements = document.querySelectorAll('.main-menu-item');

            switchScreen('main-menu-ui');
        };

        window.addEventListener('resize', () => {
            if (currentScreenId === 'main-menu-ui') {
                updateMainMenuSelector();
            }
        });

    </script>
    
    <!-- Fleshing out the placeholders for completeness -->
    <div id="greet-options-ui" class="w-full h-full p-8 flex-col items-center justify-center gap-8 hidden">
        <h1 class="text-4xl md:text-5xl font-bold tracking-tight text-gray-200 mb-8">Greetings</h1>
        <div class="grid grid-cols-3 gap-8 w-full max-w-5xl">
            <button data-action="speak" data-text="Hello" class="menu-button bg-green-500 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">Hello</span></button>
            <button data-action="speak" data-text="Hi there" class="menu-button bg-green-400 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">Hi there</span></button>
            <button data-action="speak" data-text="Good morning" class="menu-button bg-green-300 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">Good morning</span></button>
            <button data-action="speak" data-text="Good evening" class="menu-button bg-green-700 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">Good evening</span></button>
            <button data-action="speak" data-text="How are you" class="menu-button bg-green-600 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">How are you?</span></button>
            <button data-action="go-back" class="menu-button bg-gray-600 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">⬅️ Go Back</span></button>
        </div>
    </div>
    <div id="help-options-ui" class="w-full h-full p-8 flex-col items-center justify-center gap-8 hidden">
        <h1 class="text-4xl md:text-5xl font-bold tracking-tight text-gray-200 mb-8">I need help with...</h1>
        <div class="grid grid-cols-3 gap-8 w-full max-w-5xl">
            <button data-action="speak" data-text="I need the nurse" class="menu-button bg-red-500 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">Nurse</span></button>
            <button data-action="speak" data-text="I need to use the restroom" class="menu-button bg-red-400 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">Restroom</span></button>
            <button data-action="speak" data-text="My position is uncomfortable" class="menu-button bg-red-300 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">Uncomfortable</span></button>
            <button data-action="speak" data-text="I'm in pain" class="menu-button bg-red-700 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">Pain</span></button>
            <button data-action="speak" data-text="I'm cold" class="menu-button bg-red-600 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">I'm Cold</span></button>
            <button data-action="go-back" class="menu-button bg-gray-600 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">⬅️ Go Back</span></button>
        </div>
    </div>
    <div id="binge-options-ui" class="w-full h-full p-8 flex-col items-center justify-center gap-8 hidden">
        <h1 class="text-4xl md:text-5xl font-bold tracking-tight text-gray-200 mb-8">Entertainment</h1>
        <div class="grid grid-cols-3 gap-8 w-full max-w-5xl">
            <button data-action="speak" data-text="Turn on TV" class="menu-button bg-purple-500 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">TV</span></button>
            <button data-action="speak" data-text="Play music" class="menu-button bg-purple-400 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">Music</span></button>
            <button data-action="speak" data-text="Read a story" class="menu-button bg-purple-300 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">Story</span></button>
            <button data-action="speak" data-text="Show me photos" class="menu-button bg-purple-700 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">Photos</span></button>
            <button data-action="speak" data-text="I'm bored" class="menu-button bg-purple-600 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">I'm Bored</span></button>
            <button data-action="go-back" class="menu-button bg-gray-600 aspect-square rounded-2xl shadow-lg flex items-center justify-center"><span class="text-3xl font-bold">⬅️ Go Back</span></button>
        </div>
    </div>
</body>
</html>

